# 7. DNS 및 도메인 연결 (Vercel & Route 53)

EC2 인스턴스에 고정 IP를 할당하고, 구매한 도메인과 연결하여 웹 서비스에 접근할 수 있도록 설정합니다. Pull-it 팀은 **Vercel을 메인 DNS 서버로 사용**하여 프론트엔드 배포와 도메인 관리를 일원화하고 있습니다. 동시에 **AWS Route 53**도 특정 라우팅 정책이나 내부 DNS 관리 등 보조적인 역할로 함께 사용하고 있습니다.

이 문서에서는 메인 흐름인 Vercel을 기준으로 백엔드 API 서버(`api-qa.pull.it.kr`)를 연결하는 과정을 설명합니다.

## 1. Elastic IP (고정 IP) 할당

EC2 인스턴스는 재시작할 때마다 퍼블릭 IP가 변경될 수 있습니다. 도메인을 안정적으로 연결하기 위해 고정 IP인 **Elastic IP(탄력적 IP)**를 할당해야 합니다.

1.  AWS 콘솔에서 **[EC2] > [탄력적 IP]** 메뉴로 이동합니다.
2.  **[탄력적 IP 주소 할당]**을 클릭하여 새 IP를 생성합니다.
3.  생성된 IP를 선택하고 **[작업] > [탄력적 IP 주소 연결]**을 클릭합니다.
4.  연결할 EC2 인스턴스를 선택하고 연결을 완료합니다.

## 2. 도메인 구매 및 Vercel에 연결

1.  **도메인 구매**: **가비아**와 같은 도메인 등록 기관(Registrar)에서 원하는 도메인을 구매합니다.

2.  **Vercel에 도메인 추가**:
    -   Vercel 대시보드로 이동하여 DNS 설정을 관리할 프로젝트를 선택합니다.
    -   **[Settings] > [Domains]** 탭으로 이동하여 구매한 도메인을 추가합니다.
    -   Vercel이 해당 도메인을 관리하기 위한 네임서버(Nameservers) 주소들을 알려줍니다. (예: `ns1.vercel-dns.com`, `ns2.vercel-dns.com`)

3.  **네임서버 변경 (at 가비아)**:
    -   **가비아**의 도메인 관리 페이지로 돌아가, 네임서버 설정을 Vercel이 알려준 주소로 변경합니다.
    -   이 과정을 통해 "이 도메인에 대한 모든 DNS 요청은 Vercel로 보내라"고 설정하는 것입니다. (이를 **권한 위임**이라고 합니다.)

## 3. Vercel DNS 레코드 설정

네임서버 변경이 전파되면(최대 48시간 소요될 수 있음), Vercel에서 DNS 레코드를 설정할 수 있습니다.

1.  **A 레코드 생성**:
    -   Vercel 대시보드의 **[Settings] > [Domains]** 탭에서 해당 도메인을 선택합니다.
    -   DNS 레코드 관리 화면에서 새 레코드를 추가합니다.
    -   **Type:** `A`
    -   **Name:** `api-qa` (`api-qa.pull.it.kr`을 위함)
    -   **Value:** 1단계에서 생성한 EC2의 **Elastic IP 주소**
    -   레코드를 저장합니다.

> ### DNS 위임 및 조회 원리
>
> - **위임(Delegation):** 가비아의 네임서버를 Vercel의 것으로 바꾸면, 전 세계 DNS 시스템에 "이제부터 이 도메인의 주인(권한)은 Vercel이다"라고 알려주는 것과 같습니다.
> - **조회(Resolution):** 사용자가 브라우저에 `api-qa.pull.it.kr`을 입력하면, DNS 시스템은 이 위임 정보를 따라 최종적으로 Vercel에게 IP 주소를 물어보게 되고, Vercel은 등록된 A 레코드의 값(Elastic IP)을 응답해줍니다.

이제 `http://api-qa.pull.it.kr` 주소로 접속 시도 시, DNS는 우리 EC2 서버의 고정 IP를 알려주게 됩니다. 하지만 아직 웹 서버(Nginx)가 80번 포트의 요청을 어떻게 처리할지 모르기 때문에, 다음 단계에서 Nginx 설정을 진행해야 합니다.
